<mat-sidenav-container class="sidenav-container">
  <mat-sidenav #drawer class="sidenav" fixedInViewport mode="over">
    <mat-toolbar class="sidenav-toolbar">
      <mat-icon class="menu-icon">menu</mat-icon>
      <span>Menú</span>
    </mat-toolbar>
    <mat-nav-list class="nav-list">
      <a mat-list-item (click)="navigateTo('/dashboard')" [class.active]="isActiveRoute('/dashboard')" class="nav-item">
        <mat-icon matListItemIcon class="nav-icon">dashboard</mat-icon>
        <span matListItemTitle>Dashboard</span>
      </a>
      <a mat-list-item (click)="navigateTo('/clients')" [class.active]="isActiveRoute('/clients')" class="nav-item">
        <mat-icon matListItemIcon class="nav-icon">people</mat-icon>
        <span matListItemTitle>Clientes</span>
      </a>
      <a mat-list-item (click)="navigateTo('/products')" [class.active]="isActiveRoute('/products')" class="nav-item">
        <mat-icon matListItemIcon class="nav-icon">inventory</mat-icon>
        <span matListItemTitle>Productos</span>
      </a>
    </mat-nav-list>
  </mat-sidenav>

  <mat-sidenav-content>
    <mat-toolbar class="main-toolbar">
      <button type="button" aria-label="Toggle sidenav" mat-icon-button (click)="drawer.toggle()" class="menu-button">
        <mat-icon aria-label="Side nav toggle icon">menu</mat-icon>
      </button>
      <span class="toolbar-title">Financia App - Productos</span>
      <span class="spacer"></span>
      <span *ngIf="currentUser" class="user-info">Hola, {{ currentUser.email }}</span>
      <button mat-icon-button [matMenuTriggerFor]="menu" class="user-menu-button">
        <mat-icon>account_circle</mat-icon>
      </button>
      <mat-menu #menu="matMenu" class="user-menu">
        <button mat-menu-item (click)="logout()" class="menu-item">
          <mat-icon>logout</mat-icon>
          <span>Cerrar Sesión</span>
        </button>
      </mat-menu>
    </mat-toolbar>

    <div class="content">
      <div class="header-section">
        <h1 class="page-title">
          <mat-icon class="title-icon">inventory</mat-icon>
          Gestión de Productos
        </h1>
        <p class="page-subtitle">Administra y visualiza todos los productos registrados</p>
      </div>

      <div class="actions-section">
        <div class="filter-section" *ngIf="clientFilter">
          <mat-chip class="client-filter-chip">
            <mat-icon>person</mat-icon>
            Cliente ID: {{ clientFilter }}
            <button matChipRemove (click)="clearClientFilter()" class="chip-remove">
              <mat-icon>cancel</mat-icon>
            </button>
          </mat-chip>
        </div>
        <button mat-raised-button color="primary" (click)="openCreateDialog()" class="create-button">
          <mat-icon>add</mat-icon>
          Nuevo Producto
        </button>
      </div>

      <div class="table-container">
        <div *ngIf="isLoading" class="loading-container">
          <mat-spinner class="loading-spinner"></mat-spinner>
          <p class="loading-text">Cargando productos...</p>
        </div>

        <div *ngIf="!isLoading && products.length === 0" class="empty-state">
          <mat-icon class="empty-icon">inventory_2</mat-icon>
          <h3>No hay productos registrados</h3>
          <p>Comienza agregando tu primer producto</p>
          <button mat-raised-button color="primary" (click)="openCreateDialog()" class="empty-action-button">
            <mat-icon>add</mat-icon>
            Crear Producto
          </button>
        </div>

        <table *ngIf="!isLoading && products.length > 0" mat-table [dataSource]="products" class="product-table">
          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef class="table-header">ID</th>
            <td mat-cell *matCellDef="let product" class="table-cell">{{ product.id }}</td>
          </ng-container>

          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef class="table-header">Nombre</th>
            <td mat-cell *matCellDef="let product" class="table-cell">{{ product.name }}</td>
          </ng-container>

          <ng-container matColumnDef="productType">
            <th mat-header-cell *matHeaderCellDef class="table-header">Tipo</th>
            <td mat-cell *matCellDef="let product" class="table-cell">
              <span class="product-type-chip">{{ product.productType }}</span>
            </td>
          </ng-container>

          <ng-container matColumnDef="balance">
            <th mat-header-cell *matHeaderCellDef class="table-header">Saldo</th>
            <td mat-cell *matCellDef="let product" class="table-cell">
              <span class="balance-amount">$ {{ product.balance.toLocaleString() }}</span>
            </td>
          </ng-container>

          <ng-container matColumnDef="clientId">
            <th mat-header-cell *matHeaderCellDef class="table-header">Cliente ID</th>
            <td mat-cell *matCellDef="let product" class="table-cell">
              <span class="client-id-chip">{{ product.clientId }}</span>
            </td>
          </ng-container>

          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef class="table-header">Acciones</th>
            <td mat-cell *matCellDef="let product" class="table-cell">
              <div class="action-buttons">
                <button mat-icon-button color="primary" (click)="openEditDialog(product)" class="action-button edit-button" matTooltip="Editar Producto">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button color="warn" (click)="deleteProduct(product.id)" class="action-button delete-button" matTooltip="Eliminar Producto">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns" class="table-header-row"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="table-row"></tr>
        </table>
      </div>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>
